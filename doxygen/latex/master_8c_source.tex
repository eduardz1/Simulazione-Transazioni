\hypertarget{master_8c_source}{}\doxysection{master.\+c}
\label{master_8c_source}\index{src/master.c@{src/master.c}}
\mbox{\hyperlink{master_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{common_8h}{include/common.h}}"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00002}00002 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{master_8h}{include/master.h}}"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{print_8h}{include/print.h}}"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{parser_8h}{include/parser.h}}"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00006}\mbox{\hyperlink{master_8c_a153c8fd37ad2953f8ea58a227f97eb9d}{00006}} \textcolor{preprocessor}{\#define SHM\_NUM 4}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00007}\mbox{\hyperlink{master_8c_a337d58ae606f3a5ec19972a7cbc4348f}{00007}} \textcolor{preprocessor}{\#define SEM\_NUM 1}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00008}\mbox{\hyperlink{master_8c_a7c551e7044ac9e4c3b9bd15add5824f5}{00008}} \textcolor{preprocessor}{\#define IPC\_NUM 8}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00010}\mbox{\hyperlink{master_8c_af55e8c51eb649983dc307ddf43a46ee6}{00010}} \textcolor{preprocessor}{\#define USER\_NAME "{}./users"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00011}\mbox{\hyperlink{master_8c_a8cc8d559acdd2f74085b20977182d5b7}{00011}} \textcolor{preprocessor}{\#define NODE\_NAME "{}./nodes"{}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00012}00012 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00013}00013 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00014}00014 \textcolor{comment}{ ======================}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00015}00015 \textcolor{comment}{ || GLOBAL VARIABLES ||}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00016}00016 \textcolor{comment}{ ======================}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00017}00017 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00019}00019 \textcolor{comment}{/* parameters of simulation */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00020}\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{00020}} \textcolor{keyword}{struct }\mbox{\hyperlink{structparameters}{parameters}} *\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00021}\mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{00021}} \mbox{\hyperlink{structuser__t}{user}} *\mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{usersPID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00022}\mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{00022}} \mbox{\hyperlink{structnode__t}{node}} *\mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{nodesPID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00023}\mbox{\hyperlink{master_8c_a61246e5e608d3240fbbee97c978af351}{00023}} \mbox{\hyperlink{structledger__t}{ledger}} *\mbox{\hyperlink{master_8c_a61246e5e608d3240fbbee97c978af351}{mainLedger}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00025}\mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{00025}} \textcolor{keywordtype}{int} \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00027}00027 \textcolor{comment}{/*extern int usersPrematurelyDead = 0;*/}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00029}00029 \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00030}00030 \textcolor{comment}{ ======================}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00031}00031 \textcolor{comment}{ ||    FUNCTIONS     ||}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00032}00032 \textcolor{comment}{ ======================}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00033}00033 \textcolor{comment}{ */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00035}00035 \textcolor{comment}{/* make argv array with IPC IDs for user and nodes */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00036}\mbox{\hyperlink{master_8c_a0a7e9839ec9892b7a45bcc5fa69dd988}{00036}} \textcolor{keywordtype}{void} \mbox{\hyperlink{master_8c_a0a7e9839ec9892b7a45bcc5fa69dd988}{make\_arguments}}(\textcolor{keywordtype}{int} *IPC\_array, \textcolor{keywordtype}{char} **argv)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00037}00037 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00038}00038     \textcolor{keywordtype}{char} *uPID\_array = malloc(3 * \textcolor{keyword}{sizeof}(IPC\_array[0]) + 1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00039}00039     \textcolor{keywordtype}{char} *nPID\_array = malloc(3 * \textcolor{keyword}{sizeof}(IPC\_array[0]) + 1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00040}00040     \textcolor{keywordtype}{char} *\mbox{\hyperlink{structparameters}{parameters}} = malloc(3 * \textcolor{keyword}{sizeof}(IPC\_array[0]) + 1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00041}00041     \textcolor{keywordtype}{char} *\mbox{\hyperlink{structledger__t}{ledger}} = malloc(3 * \textcolor{keyword}{sizeof}(IPC\_array[0]) + 1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00042}00042     \textcolor{keywordtype}{char} *\mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}} = malloc(3 * \textcolor{keyword}{sizeof}(IPC\_array[0]) + 1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00044}00044     sprintf(uPID\_array, \textcolor{stringliteral}{"{}\%d"{}}, IPC\_array[0]);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00045}00045     sprintf(nPID\_array, \textcolor{stringliteral}{"{}\%d"{}}, IPC\_array[1]);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00046}00046     sprintf(\mbox{\hyperlink{structparameters}{parameters}}, \textcolor{stringliteral}{"{}\%d"{}}, IPC\_array[2]);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00047}00047     sprintf(\mbox{\hyperlink{structledger__t}{ledger}}, \textcolor{stringliteral}{"{}\%d"{}}, IPC\_array[3]);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00048}00048     sprintf(\mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}}, \textcolor{stringliteral}{"{}\%d"{}}, IPC\_array[4]);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00050}00050     argv[0] = \mbox{\hyperlink{master_8c_af55e8c51eb649983dc307ddf43a46ee6}{USER\_NAME}}; \textcolor{comment}{/* need nodes to have a different name but not a priority */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00051}00051     argv[1] = uPID\_array;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00052}00052     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv[uPID] = \%s\(\backslash\)n"{}}, uPID\_array))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00053}00053     argv[2] = nPID\_array;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00054}00054     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv[nPID] = \%s\(\backslash\)n"{}}, nPID\_array))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00055}00055     argv[3] = \mbox{\hyperlink{structparameters}{parameters}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00056}00056     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv[par] = \%s\(\backslash\)n"{}}, \mbox{\hyperlink{structparameters}{parameters}}))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00057}00057     argv[4] = \mbox{\hyperlink{common_8h_af8b2bdfa2bfa44284c83a9d6994b13f1}{ledger}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00058}00058     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv[ledger] = \%s\(\backslash\)n"{}}, \mbox{\hyperlink{structledger__t}{ledger}}))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00059}00059     argv[5] = \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00060}00060     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv[sem] = \%s\(\backslash\)n"{}}, \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}}))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00061}00061     argv[8] = \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}; \textcolor{comment}{/* Terminating argv with NULL value */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00062}00062 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00064}00064 \textcolor{comment}{/* fork and execve a "{}./users"{} */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00065}\mbox{\hyperlink{master_8h_a9f9715b418947b3d25eaa102b494b7eb}{00065}} pid\_t \mbox{\hyperlink{master_8c_ae58c1750af2fc1502557fa91b9258315}{spawn\_user}}(\textcolor{keywordtype}{char} *userArgv[])}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00066}00066 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00067}00067     pid\_t \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}} = fork();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00068}00068     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv values: \%s \%s \%s \%s \%s \%s\(\backslash\)n"{}}, userArgv[0], userArgv[1], userArgv[2], userArgv[3], userArgv[4], userArgv[5]))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00069}00069     \textcolor{keywordflow}{switch} (\mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}})}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00070}00070     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00071}00071     \textcolor{keywordflow}{case} -\/1: \textcolor{comment}{/* Error case */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00072}00072         printf(\textcolor{stringliteral}{"{}-\/-\/ Error forking for user\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00073}00073         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00075}00075     \textcolor{keywordflow}{case} 0: \textcolor{comment}{/* Child case */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00076}00076         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: Spawning user\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00077}00077         execve(\mbox{\hyperlink{master_8c_af55e8c51eb649983dc307ddf43a46ee6}{USER\_NAME}}, userArgv, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00078}00078         \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00079}00079         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}!! Message that should never be seen\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00080}00080         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00082}00082     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00083}00083         \textcolor{keywordflow}{return} \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00084}00084     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00085}00085 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00087}00087 \textcolor{comment}{/* fork and execve a "{}./nodes"{} */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00088}\mbox{\hyperlink{master_8h_ac4c522e4371812b5b4e5fd7982c58dd3}{00088}} pid\_t \mbox{\hyperlink{master_8c_ab9c901d29850514f861a3760fffd505f}{spawn\_node}}(\textcolor{keywordtype}{char} *nodeArgv[])}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00089}00089 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00090}00090     pid\_t \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}} = fork();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00091}00091     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: argv values: \%s \%s \%s \%s \%s \%s\(\backslash\)n"{}}, nodeArgv[0], nodeArgv[1], nodeArgv[2], nodeArgv[3], nodeArgv[4], nodeArgv[5]))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00092}00092     \textcolor{keywordflow}{switch} (\mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}})}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00093}00093     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00094}00094     \textcolor{keywordflow}{case} -\/1: \textcolor{comment}{/* Error case */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00095}00095         printf(\textcolor{stringliteral}{"{}!! Error forking for node\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00096}00096         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00098}00098     \textcolor{keywordflow}{case} 0: \textcolor{comment}{/* Child case */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00099}00099         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: Spawning node\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00100}00100         execve(\mbox{\hyperlink{master_8c_a8cc8d559acdd2f74085b20977182d5b7}{NODE\_NAME}}, nodeArgv, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00101}00101         \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00102}00102         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}!! Message that should never be seen\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00103}00103         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00105}00105     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00106}00106         \textcolor{keywordflow}{return} \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00107}00107     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00108}00108 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00110}00110 \textcolor{comment}{/* attach usersPID, nodesPID, par and mainLedger to shared memory, returns an array with respective IDs */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00111}\mbox{\hyperlink{master_8h_af65ef707ebfa9cc135e6d466c75dbda8}{00111}} \textcolor{keywordtype}{void} \mbox{\hyperlink{master_8c_a402674278f054cd8161d84815dcdd7cc}{shared\_memory\_objects\_init}}(\textcolor{keywordtype}{int} *shmArray)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00112}00112 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00113}00113     \textcolor{comment}{/* shared memory segments IDs */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00114}00114     \textcolor{keywordtype}{int} usersPID\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00115}00115     \textcolor{keywordtype}{int} nodesPID\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00116}00116     \textcolor{keywordtype}{int} mainLedger\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00117}00117     \textcolor{keywordtype}{int} par\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00119}00119     \textcolor{comment}{/* parameters init and read from conf file */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00120}00120     par\_ID = shmget(\mbox{\hyperlink{common_8h_a682c31ec4c2347e42bb80ea43ccb4438}{SHM\_PARAMETERS}}, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}), 0600 | IPC\_CREAT | IPC\_EXCL);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00121}00121     \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00122}00122     \mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}} = (\textcolor{keyword}{struct }\mbox{\hyperlink{structparameters}{parameters}} *)shmat(par\_ID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}, 0);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00123}00123     \textcolor{keywordflow}{if} (\mbox{\hyperlink{parser_8h_aa51f83495fd93bbb234b08030216c91a}{parse\_parameters}}(\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}) == \mbox{\hyperlink{parser_8h_ad223dab1d6a66f81b6b0c6c268a19a3f}{CONF\_ERROR}})}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00124}00124     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00125}00125         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}-\/-\/ Error reading conf file, defaulting to conf\#1\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00126}00126     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00127}00127     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00128}00128     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00129}00129         \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}-\/-\/ Conf file read successful\(\backslash\)n"{}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00130}00130     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00131}00131 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00132}00132     \mbox{\hyperlink{print_8h_a7632b11ea6036c833f5c2cd3cd0bb087}{print\_parameters}}(\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00133}00133 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00134}00134     \textcolor{comment}{/* (users\_t) and (nodes\_t) arrays */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00135}00135     usersPID\_ID = shmget(\mbox{\hyperlink{common_8h_a3baba14bf322fc6a6367f5ae6795d440}{SHM\_USERS\_ARRAY}},}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00136}00136                          (\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a1a7bfa0882f03d573b4e419d02f041f8}{SO\_USER\_NUM}}) * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structuser__t}{user}}),}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00137}00137                          0600 | IPC\_CREAT | IPC\_EXCL);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00138}00138     \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00139}00139     nodesPID\_ID = shmget(\mbox{\hyperlink{common_8h_a55de6fde37952d6cbbf28f2ed2299ace}{SHM\_NODES\_ARRAY}},}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00140}00140                          (\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a379d08051847c4f98268a27001b06261}{SO\_NODES\_NUM}}) * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structnode__t}{node}}),}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00141}00141                          0600 | IPC\_CREAT | IPC\_EXCL);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00142}00142     \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00143}00143     \mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{usersPID}} = (\mbox{\hyperlink{structuser__t}{user}} *)shmat(usersPID\_ID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}, 0);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00144}00144     \mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{nodesPID}} = (\mbox{\hyperlink{structnode__t}{node}} *)shmat(nodesPID\_ID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}, 0);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00146}00146     \textcolor{comment}{/* mainLedger */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00147}00147     mainLedger\_ID = shmget(\mbox{\hyperlink{common_8h_a5de1e6971273cfe0a7fdd4570401eb53}{SHM\_LEDGER}},}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00148}00148                            (\mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a379d08051847c4f98268a27001b06261}{SO\_NODES\_NUM}}) * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structnode__t}{node}}),}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00149}00149                            0600 | IPC\_CREAT | IPC\_EXCL);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00150}00150     \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00151}00151     \mbox{\hyperlink{master_8c_a61246e5e608d3240fbbee97c978af351}{mainLedger}} = (\mbox{\hyperlink{structledger__t}{ledger}} *)shmat(mainLedger\_ID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}, 0);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00153}00153     \textcolor{comment}{/* mark for deallocation so that they are automatically}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00154}00154 \textcolor{comment}{     * removed once master dies}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00155}00155 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00156}00156     shmctl(usersPID\_ID, IPC\_RMID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00157}00157     shmctl(nodesPID\_ID, IPC\_RMID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00158}00158     shmctl(par\_ID, IPC\_RMID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00159}00159     shmctl(mainLedger\_ID, IPC\_RMID, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00161}00161     shmArray[0] = usersPID\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00162}00162     shmArray[1] = nodesPID\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00163}00163     shmArray[2] = par\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00164}00164     shmArray[3] = mainLedger\_ID;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00165}00165 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00167}\mbox{\hyperlink{master_8h_a808faa6034b867dc92c3878d95cec5d0}{00167}} \textcolor{keywordtype}{void} \mbox{\hyperlink{master_8c_a808faa6034b867dc92c3878d95cec5d0}{semaphores\_init}}()}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00168}00168 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00169}00169     \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}} = semget(\mbox{\hyperlink{common_8h_a1abb954531733b3c7b64d0d78a75df2a}{SEM\_MASTER}}, 1, 0600 | IPC\_CREAT | IPC\_EXCL);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00170}00170     \mbox{\hyperlink{common_8h_a8251bcdfc5c83845e0834adf211de033}{TEST\_ERROR}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00171}00171     \mbox{\hyperlink{debug_8h_a494d31903e7b0333dfa03b0778679113}{TRACE}}((\textcolor{stringliteral}{"{}:master: semID is \%d\(\backslash\)n"{}}, \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00172}00172 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00174}00174 \textcolor{comment}{/* makes an array with every IPC object ID */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00175}\mbox{\hyperlink{master_8h_af39360a8f6b9dda80c2adfe9f456f75e}{00175}} \textcolor{keywordtype}{void} \mbox{\hyperlink{master_8c_ac58bbbc0433b1fd55eff29fd2040e88c}{make\_ipc\_array}}(\textcolor{keywordtype}{int} *IPC\_array)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00176}00176 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00177}00177     \textcolor{keywordtype}{int} shmIDs[\mbox{\hyperlink{master_8c_a153c8fd37ad2953f8ea58a227f97eb9d}{SHM\_NUM}}]; \textcolor{comment}{/* array containing every shared memory ID */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00178}00178     \textcolor{keywordtype}{int} semIDs[1] = \{0\};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00180}00180     \mbox{\hyperlink{master_8c_a402674278f054cd8161d84815dcdd7cc}{shared\_memory\_objects\_init}}(shmIDs);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00181}00181     semIDs[0] = \mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00182}00182     \textcolor{comment}{/* semaphores\_init(semIDs); */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00183}00183     memcpy(IPC\_array, shmIDs, \mbox{\hyperlink{master_8c_a153c8fd37ad2953f8ea58a227f97eb9d}{SHM\_NUM}} * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00184}00184     memcpy(IPC\_array + \mbox{\hyperlink{master_8c_a153c8fd37ad2953f8ea58a227f97eb9d}{SHM\_NUM}}, shmIDs, \mbox{\hyperlink{master_8c_a337d58ae606f3a5ec19972a7cbc4348f}{SEM\_NUM}} * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00185}00185 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00187}00187 \textcolor{comment}{/* CTRL-\/C handler */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00188}\mbox{\hyperlink{master_8h_a6732beb5ef32cd411a23cf0d8c915e37}{00188}} \textcolor{keywordtype}{void} \mbox{\hyperlink{master_8c_a6732beb5ef32cd411a23cf0d8c915e37}{master\_interrupt\_handle}}(\textcolor{keywordtype}{int} signum)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00189}00189 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00190}00190     write(1, \textcolor{stringliteral}{"{}::Master:: SIGINT ricevuto\(\backslash\)n"{}}, 28);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00191}00191     killpg(0, SIGINT);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00193}00193     \textcolor{comment}{/* just to avoid printing before everyone has finished*/}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00194}00194     sleep(1);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00195}00195     \mbox{\hyperlink{print_8h_a3210b536ef064414b1736cd2e9b7d3bd}{final\_print}}(getpid(), \mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{usersPID}}, \mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{nodesPID}}, \mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00197}00197     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00198}00198 \textcolor{comment}{    int status;}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00199}00199 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00200}00200 \textcolor{comment}{    while (wait(\&status) != -\/1)}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00201}00201 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00202}00202 \textcolor{comment}{        status >> 8; /* no idea about what it does please help *}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00203}00203 \textcolor{comment}{    \} }}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00204}00204 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00206}00206     semctl(\mbox{\hyperlink{master_8c_ae520355298e7bac453a556eeab7df45f}{semID}}, 1, IPC\_RMID);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00207}00207     exit(0);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00208}00208 \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00210}\mbox{\hyperlink{master_8c_a0ddf1224851353fc92bfbff6f499fa97}{00210}} \textcolor{keywordtype}{int} \mbox{\hyperlink{master_8c_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} *argv[])}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00211}00211 \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00212}00212     pid\_t \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}} = getpid();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00213}00213 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00214}00214     \textcolor{keywordtype}{int} uCounter, nCounter, returnVal;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00215}00215     \textcolor{keywordtype}{int} simTime;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00216}00216     \textcolor{keywordtype}{int} ipcObjectsIDs[\mbox{\hyperlink{master_8c_a7c551e7044ac9e4c3b9bd15add5824f5}{IPC\_NUM}}];}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00217}00217     \textcolor{keywordtype}{char} **argvSpawns = malloc(8*32);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00218}00218 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00219}00219     \textcolor{keyword}{struct }sigaction sa;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00220}00220     \textcolor{keyword}{struct }sembuf sops;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00222}00222     \mbox{\hyperlink{master_8c_a808faa6034b867dc92c3878d95cec5d0}{semaphores\_init}}();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00223}00223     \mbox{\hyperlink{master_8c_ac58bbbc0433b1fd55eff29fd2040e88c}{make\_ipc\_array}}(ipcObjectsIDs);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00224}00224     \mbox{\hyperlink{master_8c_a0a7e9839ec9892b7a45bcc5fa69dd988}{make\_arguments}}(ipcObjectsIDs, argvSpawns);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00225}00225     \mbox{\hyperlink{master_8c_a61246e5e608d3240fbbee97c978af351}{mainLedger}} = \mbox{\hyperlink{common_8c_a92d436f484409e36c57caaa0b45ae9da}{ledger\_init}}();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00227}00227     simTime = \mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a86c91cb21e43e2f92651c149f93f0dc5}{SO\_SIM\_SEC}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00229}00229     \textcolor{comment}{/* -\/-\/ SIGNAL HANDLER -\/-\/}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00230}00230 \textcolor{comment}{     * first set all bytes of sigation to 0}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00231}00231 \textcolor{comment}{     * then initialize sa.handler to a pointer to the function interrupt\_handle}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00232}00232 \textcolor{comment}{     * then set the handler to handle SIGINT signals ((struct sigaction *oldact) = NULL)}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00233}00233 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00234}00234     bzero(\&sa, \textcolor{keyword}{sizeof}(sa));}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00235}00235     sa.sa\_handler = \mbox{\hyperlink{master_8c_a6732beb5ef32cd411a23cf0d8c915e37}{master\_interrupt\_handle}};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00236}00236     sigaction(SIGINT, \&sa, \mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00238}00238     \textcolor{keywordflow}{for} (nCounter = 0; nCounter < \mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a379d08051847c4f98268a27001b06261}{SO\_NODES\_NUM}}; nCounter++)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00239}00239     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00240}00240         \mbox{\hyperlink{sem_8h_a0376b2ead2de10bb7ab6a4d21ec304e9}{LOCK}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00241}00241             \mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{nodesPID}}[nCounter]}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00242}00242                 .\mbox{\hyperlink{structnode__t_a3298103f7912ec98c0f00205b2ac218d}{status}} = available;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00243}00243         \mbox{\hyperlink{master_8c_a803b35477f039b41487c3b1abee12b80}{nodesPID}}[nCounter].\mbox{\hyperlink{structnode__t_ae0d46a978d5cd6707411f276ad869b9c}{pid}} = \mbox{\hyperlink{master_8c_ab9c901d29850514f861a3760fffd505f}{spawn\_node}}(argvSpawns);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00244}00244         \mbox{\hyperlink{sem_8h_ac82effb31e82e32254efc8b57251d59e}{UNLOCK}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00245}00245         \textcolor{keywordflow}{if} (getpid() != \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}})}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00246}00246         \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00247}00247             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00248}00248         \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00249}00249     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00251}00251     \textcolor{comment}{/*usersPrematurelyDead = 0;*/}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00252}00252     \textcolor{keywordflow}{for} (uCounter = 0; uCounter < \mbox{\hyperlink{master_8c_a963935917aae796fbb8f2728703adf04}{par}}-\/>\mbox{\hyperlink{structparameters_a1a7bfa0882f03d573b4e419d02f041f8}{SO\_USER\_NUM}}; uCounter++)}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00253}00253     \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00254}00254         \mbox{\hyperlink{sem_8h_a0376b2ead2de10bb7ab6a4d21ec304e9}{LOCK}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00255}00255             \mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{usersPID}}[uCounter]}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00256}00256                 .\mbox{\hyperlink{structuser__t_a2f25fcb4ca138820780f3fc6ee156d17}{status}} = alive;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00257}00257         \mbox{\hyperlink{master_8c_af667a518a4feef7b7540ebac0cd618cf}{usersPID}}[uCounter].\mbox{\hyperlink{structuser__t_ae0d46a978d5cd6707411f276ad869b9c}{pid}} = \mbox{\hyperlink{master_8c_ae58c1750af2fc1502557fa91b9258315}{spawn\_user}}(argvSpawns);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00258}00258         \mbox{\hyperlink{sem_8h_ac82effb31e82e32254efc8b57251d59e}{UNLOCK}}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00259}00259         \textcolor{keywordflow}{if} (getpid() != \mbox{\hyperlink{nodes_8c_af97c23712a0bab92e0ca95694e85282e}{myPID}})}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00260}00260         \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00261}00261             \textcolor{keywordflow}{switch} (returnVal = wait(\mbox{\hyperlink{common_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}))}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00262}00262             \{}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00263}00263             \textcolor{keywordflow}{case} \mbox{\hyperlink{common_8h_a01c3892c16d6330e486637967ab0289b}{MAX\_RETRY}}:}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00264}00264                 \textcolor{comment}{/* change status in usersPID */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00265}00265                 printf(\textcolor{stringliteral}{"{}User \%d has died because of too many retries :(\(\backslash\)n"{}}, getpid());}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00266}00266                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00267}00267             \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00269}00269             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00270}00270         \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00271}00271     \}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00273}00273     sleep(simTime);}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00274}00274 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00275}00275     \mbox{\hyperlink{print_8h_abba0d38395714b105fe448566b916b24}{print\_time\_to\_die}}();}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00276}00276     killpg(0, SIGINT); \textcolor{comment}{/* our sigint handler needs to do quite a lot of things to print the wall of test below */}}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{master_8c_source_l00278}00278     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{master_8c_source_l00279}00279 \}}

\end{DoxyCode}
